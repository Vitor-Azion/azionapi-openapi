openapi: 3.0.3
info:
  title: Data Streaming - OpenAPI
  description: |
    The Data Streaming API allows you to manage your existing data streamings and templates.
    Data Streaming allows you to feed your stream processing, SIEM, and big data platforms with the event logs from your applications on Azion in real time.

  license:
    name: MIT
    url: https://github.com/aziontech/azionapi-openapi/blob/main/LICENSE.md
  version: 1.0.0
externalDocs:
  description: See the documentation of Data Streaming for more information.
  url: https://www.azion.com/en/documentation/products/data-streaming/
servers:
  - description: Production
    url: https://api.azionapi.net
security:
  - tokenAuth: []
tags:
  - name: Data Streaming
paths:
  /data_streaming/streamings:
    get:
      tags:
        - Data Streaming
      summary: List all exist data streamings
      description: List all exist data streamings
      operationId: ListDataStreamings
      
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataStreamingResponseWithResults' 
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '429':
          description: Rate Limit
        '500':
          description: Internal Server Error
  
  /data_streaming/domains:
    get:
      tags:
        - Data Streaming Domain
      summary: List all domains used on data streaming
      description: List a data streaming info
      operationId: ListDataStreaming
      parameters: 
      - in: query
        name: name
        description: Domain's name in data streaming 
        required: false
        schema:
          type: string
      - in: query
        name: streaming_id
        required: false
        schema:
          format: int64
          type: integer
      - in: query
        name: selected
        required: false
        schema:
          type: boolean
    
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataStreamingsDomainResponse' 
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '429':
          description: Rate Limit
        '500':
          description: Internal Server Error
  
  /data_streaming/streamings/{data_streaming_id}:
    get:
      tags:
        - Data Streaming
      summary: Get expecific data streaming by Streaming ID
      description: Return a data streaming info by ID
      operationId: List Data Streaming by ID
      parameters: 
      - in: path
        required: true
        name: data_streaming_id
        schema:
          type: integer
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataStreamingsById' 
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '429':
          description: Rate Limit
        '500':
          description: Internal Server Error
              
          
  /data_streaming/templates:
    get:
      tags:
        - Data Streaming Templates
      summary: List all global Templates that can be used on Data Streaming operations
      description: Return all global Data Streaming Templates
      operationId: List Data Streaming Templates
      
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateResults' 
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
        '429':
          description: Rate Limit
        '500':
          description: Internal Server Error

components:
  schemas:
    DataStreamingResponseWithResults:
      type: object
      properties:
        results:
            type: array
            items:
              anyOf:
                - $ref: '#/components/schemas/DataStreamingResponseGetResultTypeDatadogDTS'
                - $ref: '#/components/schemas/DataStreamingResponseGetResultTypeKafka'
                - $ref: '#/components/schemas/DataStreamingResponseGetResultTypeStandard'
                - $ref: '#/components/schemas/DataStreamingResponseGetResultTypeCustom'
        schema_version: 
          type: number
   
    DataStreamingResponseGetResultTypeDatadogDTS:
      type: object
      properties:
        id: 
          type: number
          format: integer
        name:
          type: string
        template_id: 
          type: number
          format: integer
        data_source:
           type: string
        active:
          type: boolean
        endpoint:
            $ref: '#/components/schemas/DataStreamingEndpointTypeDatadogDTS'
        all_domains:
          type: boolean

    DataStreamingEndpointTypeDatadogDTS:
      type: object
      properties:
        endpoint_type:
          type: string
        url:
          type: string
          format: uri
        api_key:
          type: string
  
  
    DataStreamingResponseGetResultTypeKafka:
      type: object
      properties:
        id: 
          type: number
          format: integer
        name:
          type: string
        template_id: 
          type: number
          format: integer
        data_source:
           type: string
        active:
          type: boolean
        endpoint:
            $ref: '#/components/schemas/DataStreamingEndpointTypeKafka'
        all_domains:
          type: boolean
          
    DataStreamingEndpointTypeKafka:
      type: object
      properties:
        endpoint_type:
          type: string
        use_tls:
          type: boolean
        kafka_topic:
          type: string
        bootstrap_servers:
          type: string
          
          
    DataStreamingResponseGetResultTypeStandard:
      type: object
      properties:
        id: 
          type: number
          format: integer
        name:
          type: string
        template_id: 
          type: number
          format: integer
        data_source:
           type: string
        active:
          type: boolean
        endpoint:
            $ref: '#/components/schemas/DataStreamingEndpointTypeStandard'
        all_domains:
          type: boolean
          
    DataStreamingEndpointTypeStandard:
      type: object
      properties:
        endpoint_type:
          type: string
        url:
          type: string
          format: uri
        log_line_separator:
          type: string
        payload_format:
          type: string
        max_size:
          type: number
        headers:
          $ref: '#/components/schemas/DataStreamingEndpointTypeStandardHeadersExample'
          
    DataStreamingEndpointTypeStandardHeadersExample:
      type: object
      properties:
        header-name-1:
          type: string
          nullable: true
        header-name-2:
          type: string
          nullable: true
        header-name-3:
          type: string
          nullable: true
          
          
    DataStreamingResponseGetResultTypeCustom:
      type: object
      properties:
        id: 
          type: number
          format: integer
        name:
          type: string
        data_source:
           type: string
        active:
          type: boolean
        endpoint:
            $ref: '#/components/schemas/DataStreamingEndpointTypeKafka'
        all_domains:
          type: boolean
        template_model:
          type: string
          
    
    DataStreamingsDomainResponse:
      type: object
      properties:
        count:
          type: number
        total_pages:
          type: number
        schema_version:
          type: number
        links:
          $ref: '#/components/schemas/DataStreamingsDomainResponseLinks'
        results:
            type: array
            items:
              $ref: '#/components/schemas/DataStreamingsDomainResult'
    
    DataStreamingsDomainResponseLinks:
      type: object
      properties:
        previous:
          type: string
          nullable: true
        next:
          type: string
          nullable: true
    
    DataStreamingsDomainResult:
      type: object
      properties:
        domain_id:
          type: number
          format: integer
        name:
          type: string
        selected:
          type: boolean
          nullable: true
          
          
    DataStreamingsById:
      type: object
      properties:
        results:
          $ref: '#/components/schemas/DataStreamingResponseGetResultTypeKafka'
        schema_version: 
          type: number
          
          
    TemplateResults:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/Template'
        schema_version:
          type: number
          
    Template:
      type: object
      properties:
        id:
          type: number
          format: integer
        name:
          type: string
        template_model:
          type: string
    
      
  securitySchemes:
    tokenAuth:
      type: apiKey
      name: Authorization
      in: header
      description: |
        You must inform a token to auth.
        Usage format: `Token <TOKEN>`
        